<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced alphabet techniques • tidysq</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced alphabet techniques">
<meta property="og:description" content="tidysq">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidysq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced-alphabet.html">Advanced alphabet techniques</a>
    </li>
    <li>
      <a href="../articles/quick-start.html">Quick Start</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BioGenies/tidysq/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="advanced-alphabet_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced alphabet techniques</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BioGenies/tidysq/blob/master/vignettes/advanced-alphabet.Rmd"><code>vignettes/advanced-alphabet.Rmd</code></a></small>
      <div class="hidden name"><code>advanced-alphabet.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BioGenies/tidysq">tidysq</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'tidysq'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     paste</span></code></pre></div>
<p>Sequences in <code>sq</code> objects are compressed to take up less storage space. To achieve that, <code>sq</code> objects store an <code>alphabet</code> attribute that serves as a dictionary of possible symbols. This attribute can be accessed by its namesake function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sq_dna</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sq.html">sq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CTGAATGCAGT"</span>, <span class="st">"ATGCCGT"</span>, <span class="st">"CAGACCATT"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/alphabet.html">alphabet</a></span><span class="op">(</span><span class="va">sq_dna</span><span class="op">)</span>
<span class="co">#&gt; &lt;tidysq alphabet[5]&gt;</span>
<span class="co">#&gt; [1] A C G T -</span></code></pre></div>
<p>It is strongly discouraged to manually assign different alphabet, as it may result in undesirable behavior.</p>
<div id="standard-alphabets" class="section level2">
<h2 class="hasAnchor">
<a href="#standard-alphabets" class="anchor"></a>Standard alphabets</h2>
<p>Alphabets can be divided into standard and non-standard types. Both these groups have similar behavior, but standard alphabets have additional functionalities available due to their biological interpretation.</p>
<p>Standard alphabets can be subdivided into basic and extended alphabets, both groups closely linked. For every standard alphabet there exists a type such that if an <code>sq</code> object has this type, then its <code>alphabet</code> attribute has this alphabet as value.</p>
<div id="basic-alphabets" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-alphabets" class="anchor"></a>Basic alphabets</h3>
<p>There are three predefined basic alphabets — for DNA, RNA and amino acid sequences. They consist of all letter codes used for bases of given type, as well as gap letter “-” and (in amino acid case) stop letter “*”. Alphabets are stored as character vectors with added <code>sq_alphabet</code> class for additional methods. For instance, amino acid alphabet contains following letters: A, C, D, E, F, G, H, I, K, L, M, N, P, Q, R, S, T, V, W, Y, -, *.</p>
<p>Basic DNA/RNA alphabet is necessary for <code><a href="../reference/translate.html">translate()</a></code> operation.</p>
</div>
<div id="extended-alphabets" class="section level3">
<h3 class="hasAnchor">
<a href="#extended-alphabets" class="anchor"></a>Extended alphabets</h3>
<p>For each basic alphabet there is an extended counterpart. These three extended alphabets contain all letters from the respective basic ones and, additionally, ambiguous letters (that is, letters that mean “X-or-Y-or-Z base”, where X, Y and Z are chosen from corresponding base alphabet).</p>
<p>Both basic and extended alphabets can be acquired using <code><a href="../reference/get_standard_alphabet.html">get_standard_alphabet()</a></code> function. It uses type interpreting not to force the user to remember exact type name (although using consistent naming is beneficial to code readability):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_standard_alphabet.html">get_standard_alphabet</a></span><span class="op">(</span><span class="st">"ami_ext"</span><span class="op">)</span>
<span class="co">#&gt; &lt;tidysq alphabet[28]&gt;</span>
<span class="co">#&gt;  [1] A B C D E F G H I J K L M N O P Q R S T U V W X Y Z - *</span>
<span class="fu"><a href="../reference/get_standard_alphabet.html">get_standard_alphabet</a></span><span class="op">(</span><span class="st">"rna_bsc"</span><span class="op">)</span>
<span class="co">#&gt; &lt;tidysq alphabet[5]&gt;</span>
<span class="co">#&gt; [1] A C G U -</span>
<span class="fu"><a href="../reference/get_standard_alphabet.html">get_standard_alphabet</a></span><span class="op">(</span><span class="st">"DNA extended"</span><span class="op">)</span>
<span class="co">#&gt; &lt;tidysq alphabet[16]&gt;</span>
<span class="co">#&gt;  [1] A C G T W S M K R Y B D H V N -</span></code></pre></div>
</div>
<div id="removing-ambiguous-elements" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-ambiguous-elements" class="anchor"></a>Removing ambiguous elements</h3>
<p>When an <code>sq</code> object has an extended type, it can be converted to the basic one by utilizing <code><a href="../reference/remove_ambiguous.html">remove_ambiguous()</a></code> function. It works by removing either sequences where an ambiguous element is present or just this element, depending on <code>by_letter</code> parameter value. In the example below <code>N</code> is such an element:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sq_rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sq.html">sq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UCGGNNCAGNN"</span>, <span class="st">"AUUCGGUGA"</span>, <span class="st">"CNCUUANNNCNU"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sq_rna</span>
<span class="co">#&gt; extended RNA sequences list:</span>
<span class="co">#&gt; [1] UCGGNNCAGNN                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span>
<span class="co">#&gt; [3] CNCUUANNNCNU                                                            &lt;12&gt;</span>
<span class="fu"><a href="../reference/remove_ambiguous.html">remove_ambiguous</a></span><span class="op">(</span><span class="va">sq_rna</span><span class="op">)</span>
<span class="co">#&gt; basic RNA sequences list:</span>
<span class="co">#&gt; [1] &lt;NULL&gt;                                                                   &lt;0&gt;</span>
<span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span>
<span class="co">#&gt; [3] &lt;NULL&gt;                                                                   &lt;0&gt;</span>
<span class="fu"><a href="../reference/remove_ambiguous.html">remove_ambiguous</a></span><span class="op">(</span><span class="va">sq_rna</span>, by_letter <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; basic RNA sequences list:</span>
<span class="co">#&gt; [1] UCGGCAG                                                                  &lt;7&gt;</span>
<span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span>
<span class="co">#&gt; [3] CCUUACU                                                                  &lt;7&gt;</span></code></pre></div>
<p>Should the user wish to keep the original lengths of sequences unchanged, it’s more appropriate to use <code><a href="../reference/substitute_letters.html">substitute_letters()</a></code> function instead. The most obvious replacement is “-” gap letter, present in all standard alphabets:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/substitute_letters.html">substitute_letters</a></span><span class="op">(</span><span class="va">sq_rna</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>N <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; atp (atypical alphabet) sequences list:</span>
<span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span>
<span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span></code></pre></div>
<p>Notice, however, that returned object has <code>atp</code> alphabet instead. More on handling that in <a href="#type_manipulation">chapter about changing sq types</a>.</p>
</div>
</div>
<div id="non-standard-alphabets" class="section level2">
<h2 class="hasAnchor">
<a href="#non-standard-alphabets" class="anchor"></a>Non-standard alphabets</h2>
<p>Non-standard alphabet group consists of two types: untyped (<code>unt</code>) and atypical (<code>atp</code>). The former is a result of not specifying alphabet and being unable to find a standard alphabet that would contain all letters appearing in sequences. The latter, on the other hand, is used whenever the user specifies used alphabet explicitly. The difference can be best shown with calls to constructing <code><a href="../reference/sq.html">sq()</a></code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sq.html">sq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PFN&amp;I&amp;VO*&amp;P"</span>, <span class="st">"&amp;IO*&amp;PVO"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; unt (unspecified type) sequences list:</span>
<span class="co">#&gt; [1] PFN&amp;I&amp;VO*&amp;P                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] &amp;IO*&amp;PVO                                                                 &lt;8&gt;</span>
<span class="fu"><a href="../reference/sq.html">sq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PFN&amp;I&amp;VO*&amp;P"</span>, <span class="st">"&amp;IO*&amp;PVO"</span><span class="op">)</span>,
   alphabet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"I"</span>, <span class="st">"N"</span>, <span class="st">"O"</span>, <span class="st">"P"</span>, <span class="st">"V"</span>, <span class="st">"&amp;"</span>, <span class="st">"*"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; atp (atypical alphabet) sequences list:</span>
<span class="co">#&gt; [1] PFN&amp;I&amp;VO*&amp;P                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] &amp;IO*&amp;PVO                                                                 &lt;8&gt;</span></code></pre></div>
<p>Obviously, as with standard alphabets, atypical ones can also contain more letters than actually appear:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sq.html">sq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PFN&amp;I&amp;VO*&amp;P"</span>, <span class="st">"&amp;IO*&amp;PVO"</span><span class="op">)</span>,
   alphabet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"I"</span>, <span class="st">"N"</span>, <span class="st">"O"</span>, <span class="st">"P"</span>, <span class="st">"Q"</span>, <span class="st">"V"</span>, <span class="st">"&amp;"</span>, <span class="st">"*"</span>, <span class="st">":"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; atp (atypical alphabet) sequences list:</span>
<span class="co">#&gt; [1] PFN&amp;I&amp;VO*&amp;P                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] &amp;IO*&amp;PVO                                                                 &lt;8&gt;</span></code></pre></div>
<div id="multicharacter-alphabets" class="section level3">
<h3 class="hasAnchor">
<a href="#multicharacter-alphabets" class="anchor"></a>Multicharacter alphabets</h3>
<p>The main usage of atypical alphabets is to allow the user to handle data with multicharacter letters. For example sometimes amino acid sequences are described using three-character codes. These can be handled as shown below (although with specifying all, not only a handful of codes):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sq_multichar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sq.html">sq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TyrGlyArgArgAsp"</span>, <span class="st">"AspGlyArgGly"</span>, <span class="st">"CysGluGlyTyrProArg"</span><span class="op">)</span>,
                   alphabet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Arg"</span>, <span class="st">"Asp"</span>, <span class="st">"Cys"</span>, <span class="st">"Glu"</span>, <span class="st">"Gly"</span>, <span class="st">"Pro"</span>, <span class="st">"Tyr"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sq_multichar</span>
<span class="co">#&gt; atp (atypical alphabet) sequences list:</span>
<span class="co">#&gt; [1] Tyr Gly Arg Arg Asp                                                      &lt;5&gt;</span>
<span class="co">#&gt; [2] Asp Gly Arg Gly                                                          &lt;4&gt;</span>
<span class="co">#&gt; [3] Cys Glu Gly Tyr Pro Arg                                                  &lt;6&gt;</span></code></pre></div>
<p>These letters are treated as a whole, meaning that they are indivisible. It can be observed during letter replacement operation:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/substitute_letters.html">substitute_letters</a></span><span class="op">(</span><span class="va">sq_multichar</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Arg <span class="op">=</span> <span class="st">"X"</span>, Glu <span class="op">=</span> <span class="st">"His"</span>, Pro <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; atp (atypical alphabet) sequences list:</span>
<span class="co">#&gt; [1] Tyr Gly X X Asp                                                          &lt;5&gt;</span>
<span class="co">#&gt; [2] Asp Gly X Gly                                                            &lt;4&gt;</span>
<span class="co">#&gt; [3] Cys His Gly Tyr X X                                                      &lt;6&gt;</span></code></pre></div>
</div>
</div>
<div id="type_manipulation" class="section level2">
<h2 class="hasAnchor">
<a href="#type_manipulation" class="anchor"></a>Type manipulation</h2>
<p>As shown in previous chapters, <code><a href="../reference/substitute_letters.html">substitute_letters()</a></code> return an <code>sq</code> object of atp type. If a type isn’t satisfying, then the user can utilize <code><a href="../reference/typify.html">typify()</a></code> function that creates new <code>sq</code> object with desired type (backticks are necessary, when the substituted letter isn’t a valid variable name):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sq_unt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sq.html">sq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UCGG&amp;&amp;CAG&amp;&amp;"</span>, <span class="st">"AUUCGGUGA"</span>, <span class="st">"C&amp;CUUA&amp;&amp;&amp;C&amp;U"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sq_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/substitute_letters.html">substitute_letters</a></span><span class="op">(</span><span class="va">sq_unt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`&amp;` <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sq_sub</span>
<span class="co">#&gt; atp (atypical alphabet) sequences list:</span>
<span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span>
<span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span>
<span class="fu"><a href="../reference/typify.html">typify</a></span><span class="op">(</span><span class="va">sq_sub</span>, <span class="st">"rna_bsc"</span><span class="op">)</span>
<span class="co">#&gt; basic RNA sequences list:</span>
<span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span>
<span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span></code></pre></div>
<p>However, one should note that there is a requirement for <code><a href="../reference/typify.html">typify()</a></code> to work — typified <code>sq</code> object must not contain any letters not in the target alphabet. For instance, following call won’t work:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/typify.html">typify</a></span><span class="op">(</span><span class="va">sq_sub</span>, <span class="st">"dna_bsc"</span><span class="op">)</span>
<span class="co">#&gt; Error in CPP_typify(x, dest_type, NA_letter): sq object contains letters that do not appear in the alphabet of target type</span></code></pre></div>
<p>The user isn’t left alone to guess whether a sequence has invalid letters or not. In this case they can use <code><a href="../reference/find_invalid_letters.html">find_invalid_letters()</a></code> function that returns a list of character vectors, where each vector contains invalid letter for corresponding sequence:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/find_invalid_letters.html">find_invalid_letters</a></span><span class="op">(</span><span class="va">sq_sub</span>, <span class="st">"dna_bsc"</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "U"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "U"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] "U"</span></code></pre></div>
<p>However, all invalid letters within an alphabet have to be substituted before passing it to <code><a href="../reference/typify.html">typify()</a></code>. A more complicated call that replaces all ambiguous letters with “-” gap letter can be constructed as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ambiguous_letters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html">setdiff</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/get_standard_alphabet.html">get_standard_alphabet</a></span><span class="op">(</span><span class="st">"rna_ext"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/get_standard_alphabet.html">get_standard_alphabet</a></span><span class="op">(</span><span class="st">"rna_bsc"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">encoding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ambiguous_letters</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">encoding</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ambiguous_letters</span>
<span class="va">encoding</span>
<span class="co">#&gt;   W   S   M   K   R   Y   B   D   H   V   N </span>
<span class="co">#&gt; "-" "-" "-" "-" "-" "-" "-" "-" "-" "-" "-"</span>

<span class="va">sq_rna_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/substitute_letters.html">substitute_letters</a></span><span class="op">(</span><span class="va">sq_rna</span>, <span class="va">encoding</span><span class="op">)</span>
<span class="fu"><a href="../reference/typify.html">typify</a></span><span class="op">(</span><span class="va">sq_rna_sub</span>, <span class="st">"rna_bsc"</span><span class="op">)</span>
<span class="co">#&gt; atp (atypical alphabet) sequences list:</span>
<span class="co">#&gt; [1] UCGG--CAG--                                                             &lt;11&gt;</span>
<span class="co">#&gt; [2] AUUCGGUGA                                                                &lt;9&gt;</span>
<span class="co">#&gt; [3] C-CUUA---C-U                                                            &lt;12&gt;</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dominik Rafacz, Michal Burdukiewicz, Laura Bakala.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
